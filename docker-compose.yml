version: '3.8'

services:
  # 1. ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ Back-end (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ï‡πà‡πÄ‡∏≠‡∏≤ working_dir ‡∏≠‡∏≠‡∏Å)
  backend:
    build: ./DGA-back
    command: npm run dev
    volumes:
      - ./DGA-back:/usr/src/app
      - /usr/src/app/node_modules
    env_file:
      - ./DGA-back/.env
    ports:
      - "1040:1040" # üëà Port ‡∏à‡∏≤‡∏Å .env ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    environment:
      - NODE_ENV=development

  # 2. ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ Front-end (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Production)
  frontend:
    build: ./DGA-frontend # üëà ‡∏ô‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏±‡∏ô Dockerfile ‡πÉ‡∏´‡∏°‡πà (npm run build)
    
    # ‚ÄºÔ∏è ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ 'volumes' ‡πÅ‡∏•‡πâ‡∏ß ‚ÄºÔ∏è
    # (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà Build "‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô" Image)
    
    # ‚ÄºÔ∏è ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ 'command' ‚ÄºÔ∏è
    # (‡πÄ‡∏û‡∏£‡∏≤‡∏∞ 'Dockerfile' ‡∏°‡∏µ CMD ["serve", ...] ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)

    ports:
      - "8080:5174" # üëà (Host Port:Container Port)
    
    depends_on:
      - backend